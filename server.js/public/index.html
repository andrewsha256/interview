<html>
    <head>
        <title>Express</title>
        <link rel="stylesheet" href="/stylesheets/style.css" />
    </head>

    <body>
        <h1>Express</h1>
        <p>Welcome to Express</p>

        <p>
            <select id="uri-select">
                <option value="asyncawait-factory">asyncawait-factory</option>
                <option value="asyncawait-router">asyncawait-router</option>
                <option value="promise-router">promise-router</option>
            </select>
        </p>
        <p><button onclick="test()">Test</button></p>
        <p><textarea id="data" rows="20" cols="80"></textarea></p>

        <script type="text/javascript">
            function test() {
                for (let counter = 0; counter < 10; counter++) {
                    const login = counter % 2 ? 'guest' : 'admin';
                    loginAs(login);
                }
            }

            function loginAs(user) {
                fetch(getUrl() + '/?login=' + user)
                    .then((response) => {
                        return response.json();
                    })
                    .then((data) => {
                        document.getElementById('data').value +=
                            JSON.stringify(data) + '\n';
                    });
            }

            function getUrl() {
                return (
                    'http://localhost:3000/' +
                    document.getElementById('uri-select').value +
                    '/data'
                );
            }
        </script>
    </body>
</html>
